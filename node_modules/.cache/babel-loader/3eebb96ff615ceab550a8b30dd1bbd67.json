{"remainingRequest":"C:\\Users\\a\\Desktop\\Vue3.0\\京东到家项目\\京东到家3\\jingdong\\node_modules\\babel-loader\\lib\\index.js!C:\\Users\\a\\Desktop\\Vue3.0\\京东到家项目\\京东到家3\\jingdong\\node_modules\\cache-loader\\dist\\cjs.js??ref--1-0!C:\\Users\\a\\Desktop\\Vue3.0\\京东到家项目\\京东到家3\\jingdong\\node_modules\\vue-loader-v16\\dist\\index.js??ref--1-1!C:\\Users\\a\\Desktop\\Vue3.0\\京东到家项目\\京东到家3\\jingdong\\src\\views\\orderConfirmation\\Order.vue?vue&type=script&lang=js","dependencies":[{"path":"C:\\Users\\a\\Desktop\\Vue3.0\\京东到家项目\\京东到家3\\jingdong\\src\\views\\orderConfirmation\\Order.vue","mtime":1651666533081},{"path":"C:\\Users\\a\\Desktop\\Vue3.0\\京东到家项目\\京东到家3\\jingdong\\babel.config.js","mtime":1648882729795},{"path":"C:\\Users\\a\\Desktop\\Vue3.0\\京东到家项目\\京东到家3\\jingdong\\node_modules\\cache-loader\\dist\\cjs.js","mtime":499162500000},{"path":"C:\\Users\\a\\Desktop\\Vue3.0\\京东到家项目\\京东到家3\\jingdong\\node_modules\\babel-loader\\lib\\index.js","mtime":315532800000},{"path":"C:\\Users\\a\\Desktop\\Vue3.0\\京东到家项目\\京东到家3\\jingdong\\node_modules\\cache-loader\\dist\\cjs.js","mtime":499162500000},{"path":"C:\\Users\\a\\Desktop\\Vue3.0\\京东到家项目\\京东到家3\\jingdong\\node_modules\\vue-loader-v16\\dist\\index.js","mtime":499162500000}],"contextDependencies":[],"result":[{"type":"Buffer","data":"base64:aW1wb3J0IF9hc3luY1RvR2VuZXJhdG9yIGZyb20gIkM6L1VzZXJzL2EvRGVza3RvcC9WdWUzLjAvXHU0RUFDXHU0RTFDXHU1MjMwXHU1QkI2XHU5ODc5XHU3NkVFL1x1NEVBQ1x1NEUxQ1x1NTIzMFx1NUJCNjMvamluZ2Rvbmcvbm9kZV9tb2R1bGVzL0BiYWJlbC9ydW50aW1lL2hlbHBlcnMvZXNtL2FzeW5jVG9HZW5lcmF0b3IuanMiOwppbXBvcnQgInJlZ2VuZXJhdG9yLXJ1bnRpbWUvcnVudGltZS5qcyI7CmltcG9ydCB7IHJlZiB9IGZyb20gJ3Z1ZSc7CmltcG9ydCB7IHVzZVJvdXRlciwgdXNlUm91dGUgfSBmcm9tICd2dWUtcm91dGVyJzsKaW1wb3J0IHsgdXNlU3RvcmUgfSBmcm9tICd2dWV4JzsKaW1wb3J0IHsgcG9zdCB9IGZyb20gJy4uLy4uL3V0aWxzL3JlcXVlc3QnOwppbXBvcnQgeyB1c2VDb21tb25DYXJ0RWZmZWN0IH0gZnJvbSAnLi4vLi4vZWZmZWN0cy9jYXJ0RWZmZWN0cyc7IC8vIOS4i+WNleebuOWFs+mAu+i+kQoKdmFyIHVzZU1ha2VPcmRlckVmZmVjdCA9IGZ1bmN0aW9uIHVzZU1ha2VPcmRlckVmZmVjdChzaG9wSWQsIHNob3BOYW1lLCBwcm9kdWN0TGlzdCkgewogIHZhciByb3V0ZXIgPSB1c2VSb3V0ZXIoKTsKICB2YXIgc3RvcmUgPSB1c2VTdG9yZSgpOwoKICB2YXIgaGFuZGxlQ29uZmlybU9yZGVyID0gLyojX19QVVJFX18qL2Z1bmN0aW9uICgpIHsKICAgIHZhciBfcmVmID0gX2FzeW5jVG9HZW5lcmF0b3IoIC8qI19fUFVSRV9fKi9yZWdlbmVyYXRvclJ1bnRpbWUubWFyayhmdW5jdGlvbiBfY2FsbGVlKGlzQ2FuY2VsZWQpIHsKICAgICAgdmFyIHByb2R1Y3RzLCBpLCBwcm9kdWN0LCByZXN1bHQ7CiAgICAgIHJldHVybiByZWdlbmVyYXRvclJ1bnRpbWUud3JhcChmdW5jdGlvbiBfY2FsbGVlJChfY29udGV4dCkgewogICAgICAgIHdoaWxlICgxKSB7CiAgICAgICAgICBzd2l0Y2ggKF9jb250ZXh0LnByZXYgPSBfY29udGV4dC5uZXh0KSB7CiAgICAgICAgICAgIGNhc2UgMDoKICAgICAgICAgICAgICBwcm9kdWN0cyA9IFtdOwoKICAgICAgICAgICAgICBmb3IgKGkgaW4gcHJvZHVjdExpc3QudmFsdWUpIHsKICAgICAgICAgICAgICAgIHByb2R1Y3QgPSBwcm9kdWN0TGlzdC52YWx1ZVtpXTsKICAgICAgICAgICAgICAgIHByb2R1Y3RzLnB1c2goewogICAgICAgICAgICAgICAgICBpZDogcGFyc2VJbnQocHJvZHVjdC5faWQsIDEwKSwKICAgICAgICAgICAgICAgICAgbnVtOiBwcm9kdWN0LmNvdW50CiAgICAgICAgICAgICAgICB9KTsKICAgICAgICAgICAgICB9CgogICAgICAgICAgICAgIF9jb250ZXh0LnByZXYgPSAyOwogICAgICAgICAgICAgIF9jb250ZXh0Lm5leHQgPSA1OwogICAgICAgICAgICAgIHJldHVybiBwb3N0KCcvYXBpL29yZGVyJywgewogICAgICAgICAgICAgICAgYWRkcmVzc0lkOiAxLAogICAgICAgICAgICAgICAgc2hvcElkOiBzaG9wSWQsCiAgICAgICAgICAgICAgICBzaG9wTmFtZTogc2hvcE5hbWUudmFsdWUsCiAgICAgICAgICAgICAgICBpc0NhbmNlbGVkOiBpc0NhbmNlbGVkLAogICAgICAgICAgICAgICAgcHJvZHVjdHM6IHByb2R1Y3RzCiAgICAgICAgICAgICAgfSk7CgogICAgICAgICAgICBjYXNlIDU6CiAgICAgICAgICAgICAgcmVzdWx0ID0gX2NvbnRleHQuc2VudDsKCiAgICAgICAgICAgICAgaWYgKChyZXN1bHQgPT09IG51bGwgfHwgcmVzdWx0ID09PSB2b2lkIDAgPyB2b2lkIDAgOiByZXN1bHQuZXJybm8pID09PSAwKSB7CiAgICAgICAgICAgICAgICBzdG9yZS5jb21taXQoJ2NsZWFyQ2FydERhdGEnLCBzaG9wSWQpOwogICAgICAgICAgICAgICAgcm91dGVyLnB1c2goewogICAgICAgICAgICAgICAgICBuYW1lOiAnT3JkZXJMaXN0JwogICAgICAgICAgICAgICAgfSk7CiAgICAgICAgICAgICAgfQoKICAgICAgICAgICAgICBfY29udGV4dC5uZXh0ID0gMTE7CiAgICAgICAgICAgICAgYnJlYWs7CgogICAgICAgICAgICBjYXNlIDk6CiAgICAgICAgICAgICAgX2NvbnRleHQucHJldiA9IDk7CiAgICAgICAgICAgICAgX2NvbnRleHQudDAgPSBfY29udGV4dFsiY2F0Y2giXSgyKTsKCiAgICAgICAgICAgIGNhc2UgMTE6CiAgICAgICAgICAgIGNhc2UgImVuZCI6CiAgICAgICAgICAgICAgcmV0dXJuIF9jb250ZXh0LnN0b3AoKTsKICAgICAgICAgIH0KICAgICAgICB9CiAgICAgIH0sIF9jYWxsZWUsIG51bGwsIFtbMiwgOV1dKTsKICAgIH0pKTsKCiAgICByZXR1cm4gZnVuY3Rpb24gaGFuZGxlQ29uZmlybU9yZGVyKF94KSB7CiAgICAgIHJldHVybiBfcmVmLmFwcGx5KHRoaXMsIGFyZ3VtZW50cyk7CiAgICB9OwogIH0oKTsKCiAgcmV0dXJuIHsKICAgIGhhbmRsZUNvbmZpcm1PcmRlcjogaGFuZGxlQ29uZmlybU9yZGVyCiAgfTsKfTsgLy8g6JKZ5bGC5bGV56S655u45YWz55qE6YC76L6RCgoKdmFyIHVzZVNob3dNYXNrRWZmZWN0ID0gZnVuY3Rpb24gdXNlU2hvd01hc2tFZmZlY3QoKSB7CiAgdmFyIHNob3dDb25maXJtID0gcmVmKGZhbHNlKTsKCiAgdmFyIGhhbmRsZVNob3dDb25maXJtQ2hhbmdlID0gZnVuY3Rpb24gaGFuZGxlU2hvd0NvbmZpcm1DaGFuZ2Uoc3RhdHVzKSB7CiAgICBzaG93Q29uZmlybS52YWx1ZSA9IHN0YXR1czsKICB9OwoKICByZXR1cm4gewogICAgc2hvd0NvbmZpcm06IHNob3dDb25maXJtLAogICAgaGFuZGxlU2hvd0NvbmZpcm1DaGFuZ2U6IGhhbmRsZVNob3dDb25maXJtQ2hhbmdlCiAgfTsKfTsKCmV4cG9ydCBkZWZhdWx0IHsKICBuYW1lOiAnT3JkZXInLAogIHNldHVwOiBmdW5jdGlvbiBzZXR1cCgpIHsKICAgIHZhciByb3V0ZSA9IHVzZVJvdXRlKCk7CiAgICB2YXIgc2hvcElkID0gcGFyc2VJbnQocm91dGUucGFyYW1zLmlkLCAxMCk7CgogICAgdmFyIF91c2VDb21tb25DYXJ0RWZmZWN0ID0gdXNlQ29tbW9uQ2FydEVmZmVjdChzaG9wSWQpLAogICAgICAgIGNhbGN1bGF0aW9ucyA9IF91c2VDb21tb25DYXJ0RWZmZWN0LmNhbGN1bGF0aW9ucywKICAgICAgICBzaG9wTmFtZSA9IF91c2VDb21tb25DYXJ0RWZmZWN0LnNob3BOYW1lLAogICAgICAgIHByb2R1Y3RMaXN0ID0gX3VzZUNvbW1vbkNhcnRFZmZlY3QucHJvZHVjdExpc3Q7CgogICAgdmFyIF91c2VNYWtlT3JkZXJFZmZlY3QgPSB1c2VNYWtlT3JkZXJFZmZlY3Qoc2hvcElkLCBzaG9wTmFtZSwgcHJvZHVjdExpc3QpLAogICAgICAgIGhhbmRsZUNvbmZpcm1PcmRlciA9IF91c2VNYWtlT3JkZXJFZmZlY3QuaGFuZGxlQ29uZmlybU9yZGVyOwoKICAgIHZhciBfdXNlU2hvd01hc2tFZmZlY3QgPSB1c2VTaG93TWFza0VmZmVjdCgpLAogICAgICAgIHNob3dDb25maXJtID0gX3VzZVNob3dNYXNrRWZmZWN0LnNob3dDb25maXJtLAogICAgICAgIGhhbmRsZVNob3dDb25maXJtQ2hhbmdlID0gX3VzZVNob3dNYXNrRWZmZWN0LmhhbmRsZVNob3dDb25maXJtQ2hhbmdlOwoKICAgIHJldHVybiB7CiAgICAgIHNob3dDb25maXJtOiBzaG93Q29uZmlybSwKICAgICAgaGFuZGxlU2hvd0NvbmZpcm1DaGFuZ2U6IGhhbmRsZVNob3dDb25maXJtQ2hhbmdlLAogICAgICBjYWxjdWxhdGlvbnM6IGNhbGN1bGF0aW9ucywKICAgICAgaGFuZGxlQ29uZmlybU9yZGVyOiBoYW5kbGVDb25maXJtT3JkZXIKICAgIH07CiAgfQp9Ow=="},{"version":3,"mappings":"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","names":["ref","useRouter","useRoute","useStore","post","useCommonCartEffect","useMakeOrderEffect","shopId","shopName","productList","router","store","handleConfirmOrder","isCanceled","products","i","value","product","push","id","parseInt","_id","num","count","addressId","result","errno","commit","name","useShowMaskEffect","showConfirm","handleShowConfirmChange","status","setup","route","params","calculations"],"sourceRoot":"","sources":["C:\\Users\\a\\Desktop\\Vue3.0\\京东到家项目\\京东到家3\\jingdong\\src\\views\\orderConfirmation\\Order.vue"],"sourcesContent":["<template>\r\n  <div class=\"order\">\r\n    <div class=\"order__price\">实付金额 <b>¥{{calculations.price}}</b></div>\r\n    <div class=\"order__btn\" @click=\"() => handleShowConfirmChange(true)\">提交订单</div>\r\n  </div>\r\n  <div\r\n    class=\"mask\"\r\n    v-show=\"showConfirm\"\r\n    @click=\"() => handleShowConfirmChange(false)\"\r\n  >\r\n    <div class=\"mask__content\" @click.stop>\r\n      <h3 class=\"mask__content__title\">确认要离开收银台？</h3>\r\n      <p class=\"mask__content__desc\">请尽快完成支付，否则将被取消</p>\r\n      <div class=\"mask__content__btns\">\r\n        <div\r\n          class=\"mask__content__btn mask__content__btn--first\"\r\n          @click=\"() => handleConfirmOrder(true)\"\r\n        >取消订单</div>\r\n        <div\r\n          class=\"mask__content__btn mask__content__btn--last\"\r\n          @click=\"() => handleConfirmOrder(false)\"\r\n        >确认支付</div>\r\n      </div>\r\n    </div>\r\n  </div>\r\n</template>\r\n\r\n<script>\r\nimport { ref } from 'vue'\r\nimport { useRouter, useRoute } from 'vue-router'\r\nimport { useStore } from 'vuex'\r\nimport { post } from '../../utils/request'\r\nimport { useCommonCartEffect } from '../../effects/cartEffects'\r\n\r\n// 下单相关逻辑\r\nconst useMakeOrderEffect = (shopId, shopName, productList) => {\r\n  const router = useRouter()\r\n  const store = useStore()\r\n\r\n  const handleConfirmOrder = async (isCanceled) => {\r\n    const products = []\r\n    for (const i in productList.value) {\r\n      const product = productList.value[i]\r\n      products.push({ id: parseInt(product._id, 10), num: product.count })\r\n    }\r\n    try {\r\n      const result = await post('/api/order', {\r\n        addressId: 1,\r\n        shopId,\r\n        shopName: shopName.value,\r\n        isCanceled,\r\n        products\r\n      })\r\n      if (result?.errno === 0) {\r\n        store.commit('clearCartData', shopId)\r\n        router.push({ name: 'OrderList' })\r\n      }\r\n    } catch (e) {\r\n      // 提示下单失败\r\n    }\r\n  }\r\n  return { handleConfirmOrder }\r\n}\r\n\r\n// 蒙层展示相关的逻辑\r\nconst useShowMaskEffect = () => {\r\n  const showConfirm = ref(false)\r\n  const handleShowConfirmChange = (status) => {\r\n    showConfirm.value = status\r\n  }\r\n  return { showConfirm, handleShowConfirmChange }\r\n}\r\n\r\nexport default {\r\n  name: 'Order',\r\n  setup () {\r\n    const route = useRoute()\r\n    const shopId = parseInt(route.params.id, 10)\r\n    const { calculations, shopName, productList } = useCommonCartEffect(shopId)\r\n    const { handleConfirmOrder } = useMakeOrderEffect(shopId, shopName, productList)\r\n    const { showConfirm, handleShowConfirmChange } = useShowMaskEffect()\r\n    return { showConfirm, handleShowConfirmChange, calculations, handleConfirmOrder }\r\n  }\r\n}\r\n</script>\r\n\r\n<style lang=\"scss\" scoped>\r\n@import '../../style/viriables.scss';\r\n.order {\r\n  position: absolute;\r\n  left: 0;\r\n  right: 0;\r\n  bottom: 0;\r\n  display: flex;\r\n  height: .49rem;\r\n  line-height: .49rem;\r\n  background: $bgColor;\r\n  &__price {\r\n    flex: 1;\r\n    text-indent: .24rem;\r\n    font-size: .14rem;\r\n    color: $content-fontcolor;\r\n  }\r\n  &__btn {\r\n    width: .98rem;\r\n    background: #4FB0F9;\r\n    color: #fff;\r\n    text-align: center;\r\n    font-size: .14rem;\r\n  }\r\n}\r\n.mask {\r\n  z-index: 1;\r\n  position: absolute;\r\n  left: 0;\r\n  right: 0;\r\n  bottom: 0;\r\n  top: 0;\r\n  background: rgba(0,0,0,0.50);\r\n  &__content {\r\n    position: absolute;\r\n    top: 50%;\r\n    left: 50%;\r\n    transform: translate(-50%, -50%);\r\n    width: 3rem;\r\n    height: 1.56rem;\r\n    background: #FFF;\r\n    text-align: center;\r\n    border-radius: .04rem;\r\n    &__title {\r\n      margin: .24rem 0 0 0;\r\n      line-height: .26rem;\r\n      font-size: .18rem;\r\n      color: #333;\r\n    }\r\n    &__desc {\r\n      margin: .08rem 0 0 0;\r\n      font-size: .14rem;\r\n      color: #666666;\r\n    }\r\n    &__btns {\r\n      display: flex;\r\n      margin: .24rem .58rem;\r\n    }\r\n    &__btn {\r\n      flex: 1;\r\n      width: .8rem;\r\n      line-height: .32rem;\r\n      border-radius: .16rem;\r\n      font-size: .14rem;\r\n      &--first {\r\n        margin-right: .12rem;\r\n        border: .01rem solid #4FB0F9;\r\n        color: #4FB0F9;\r\n      }\r\n      &--last {\r\n        margin-left: .12rem;\r\n        background: #4FB0F9;\r\n        color: #fff;\r\n      }\r\n    }\r\n  }\r\n}\r\n</style>\r\n"]}]}